var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},SceneBase=function(e){function t(){var t=e.call(this)||this;return t.m_onLeaveScene=null,t.m_onLeaveThisObj=null,t}return __extends(t,e),t.prototype.initScene=function(){},t.prototype.setLeaveSceneCallBack=function(e,t){this.m_onLeaveScene=e,this.m_onLeaveThisObj=t},t}(eui.Group);__reflect(SceneBase.prototype,"SceneBase");var ZephProgress=function(e){function t(t,i,s,o,n,r,a){void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=!1);var h=e.call(this)||this;return h.m_BGImage=null,h.m_ProgressTempImage=null,h.m_ProgressImage=null,h.m_IconImage=null,h.m_ProgressRate=0,h.m_IconOriginX=0,h.m_IconOriginY=0,h.m_bgUrl=null,h.m_prgsUrl=null,h.m_iconUrl=null,h.m_sheetUrl=null,h.m_onFinishedFunc=null,h.m_thisObject=null,h.m_resItem=null,h.m_showText=!1,h.m_rateText=null,h.m_bgUrl=s,h.m_prgsUrl=o,h.m_iconUrl=n,h.m_sheetUrl=r,h.m_onFinishedFunc=t,h.m_thisObject=i,h.m_showText=a,h.m_sheetUrl?h.loadFromSheet():h.loadFromRes(),h}return __extends(t,e),t.prototype.loadFromSheet=function(){this.m_sheetUrl&&RES.getResByUrl(this.m_sheetUrl,this.onLoadSheetComplete,this,RES.ResourceItem.TYPE_SHEET)},t.prototype.onLoadSheetComplete=function(e){if(e){this.m_resItem=e;var t=e.getTexture(this.m_bgUrl);t&&(this.m_BGImage=new eui.Image,this.m_BGImage.texture=t,this.m_BGImage.width=t.textureWidth,this.m_BGImage.height=t.textureHeight,this.addChild(this.m_BGImage));var i=e.getTexture(this.m_prgsUrl);i&&(this.m_ProgressImage=new eui.Image,this.addChild(this.m_ProgressImage),this.m_ProgressTempImage=new eui.Image,this.m_ProgressTempImage.texture=i);var s=e.getTexture(this.m_iconUrl);s&&(this.m_IconImage=new eui.Image,this.m_IconImage.texture=s,this.m_IconImage.width=s.textureWidth,this.m_IconImage.height=s.textureHeight,this.m_IconImage.anchorOffsetX=this.m_IconImage.width/2,this.m_IconImage.anchorOffsetY=this.m_IconImage.height/2,this.addChild(this.m_IconImage)),this.onLoadFinished()}},t.prototype.loadFromRes=function(){var e=RES.getRes(this.m_bgUrl);e&&(this.m_BGImage=new eui.Image,this.m_BGImage.texture=e,this.m_BGImage.width=e.textureWidth,this.m_BGImage.height=e.textureHeight,this.addChild(this.m_BGImage));var t=RES.getRes(this.m_prgsUrl);t&&(this.m_ProgressImage=new eui.Image,this.addChild(this.m_ProgressImage),this.m_ProgressTempImage=new eui.Image,this.m_ProgressTempImage.texture=t);var i=RES.getRes(this.m_iconUrl);i&&(this.m_IconImage=new eui.Image,this.m_IconImage.texture=i,this.m_IconImage.width=i.textureWidth,this.m_IconImage.height=i.textureHeight,this.m_IconImage.anchorOffsetX=this.m_IconImage.width/2,this.m_IconImage.anchorOffsetY=this.m_IconImage.height/2,this.addChild(this.m_IconImage)),this.onLoadFinished()},t.prototype.onLoadFinished=function(){this.m_BGImage&&(this.width=this.m_BGImage.width,this.height=this.m_BGImage.height),this.m_showText&&this.m_resItem&&(this.m_rateText=new ZephBMPFontLabel(this.m_resItem,-2),this.addChild(this.m_rateText)),this.setProgressRate(0),this.m_onFinishedFunc&&this.m_onFinishedFunc.call(this.m_thisObject)},t.prototype.setProgressRate=function(e){0>e||e>100||(this.m_ProgressRate=e,this.updateProgressRate(e),this.updateIcon(e),this.updateRateText(e))},t.prototype.addProgressRate=function(e){0>e||e>100||(this.m_ProgressRate+=e,this.m_ProgressRate>100&&(this.m_ProgressRate=100),this.updateProgressRate(this.m_ProgressRate),this.updateIcon(this.m_ProgressRate),this.updateRateText(this.m_ProgressRate))},t.prototype.updateRateText=function(e){!this.m_rateText||0>e||e>100||this.m_rateText.setText(Math.ceil(e)+"%")},t.prototype.updateProgressRate=function(e){if(!(!this.m_ProgressTempImage||!this.m_ProgressImage||0>e||e>100)){var t=new egret.RenderTexture;t.drawToTexture(this.m_ProgressTempImage,new egret.Rectangle(0,0,this.m_ProgressTempImage.width*e/100,this.m_ProgressTempImage.height)),this.m_ProgressImage.texture=t,this.m_ProgressImage.width=t.textureWidth,this.m_ProgressImage.height=t.textureHeight,100==e&&this.m_onFinishedFunc&&this.m_onFinishedFunc.call(this.m_thisObject)}},t.prototype.updateIcon=function(e){!this.m_IconImage||!this.m_ProgressTempImage||0>e||e>100||(this.m_IconImage.x=this.m_IconOriginX+(this.m_ProgressTempImage.width-this.m_IconImage.width/2)*e/100)},t.prototype.setRateTextOffset=function(e,t){this.m_rateText&&(this.m_rateText.x+=e,this.m_rateText.y+=t)},t.prototype.setProgressOffset=function(e,t){this.m_ProgressImage&&(this.m_ProgressImage.x+=e,this.m_ProgressImage.y+=t)},t.prototype.setIconOffset=function(e,t){this.m_IconImage&&(this.m_IconImage.x+=e,this.m_IconImage.y+=t,this.m_IconOriginX=this.m_IconImage.x,this.m_IconOriginY=this.m_IconImage.y)},t}(eui.Group);__reflect(ZephProgress.prototype,"ZephProgress");var MyPrizeItem=function(e){function t(t){var i=e.call(this)||this;return i.initItem(t),i}return __extends(t,e),t.prototype.initItem=function(e){if(e){var t=new egret.Bitmap;if(t.texture=RES.getRes("harvest_json.item_bg"),this.addChild(t),this.width=t.width,this.height=t.height,e.m_sIconName){var i=new egret.Bitmap;i.texture=RES.getRes(e.m_sIconName),i.x=20,i.y=(this.height-i.height)/2,this.addChild(i)}if(e.m_sItemName){var s=new egret.TextField;s.text=e.m_sItemName,s.size=26,s.textColor=16777215,s.x=i.x+i.width+20,s.y=(this.height-s.height)/2,this.addChild(s)}if(e.m_sDateTime){var o=new egret.TextField;o.text=e.m_sDateTime,o.size=16,o.multiline=!0,o.width=90,o.textColor=16777215,o.x=this.width-110,o.y=(this.height-o.height)/2,this.addChild(o)}}},t}(eui.Group);__reflect(MyPrizeItem.prototype,"MyPrizeItem");var PrizeItemData=function(){function e(){this.m_sIconName="",this.m_sItemName="",this.m_sDateTime=""}return e}();__reflect(PrizeItemData.prototype,"PrizeItemData");var LoadingScene=function(e){function t(){var t=e.call(this)||this;return t.prog=null,t}return __extends(t,e),t.prototype.initScene=function(){var e=new egret.Shape;e.graphics.beginFill(0),e.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight),e.graphics.endFill(),this.addChild(e),this.prog=new ZephProgress(this.onLoadStart,this,"pbg","progress","worm","resource/assets/loading.json",!0),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.m_onLeaveScene&&this.m_onLeaveScene.call(this.m_onLeaveThisObj))},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.onLoadStart=function(){this.prog.x=this.width/2,this.prog.y=this.height/2,this.prog.anchorOffsetX=this.prog.width/2,this.prog.anchorOffsetY=this.prog.height/2,this.prog.setProgressOffset(10,8),this.prog.setIconOffset(10,-10),this.prog.setRateTextOffset(170,8),this.addChild(this.prog)},t.prototype.setProgress=function(e,t){this.prog.setProgressRate(e/t*100)},t}(SceneBase);__reflect(LoadingScene.prototype,"LoadingScene");var GuideScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(SceneBase);__reflect(GuideScene.prototype,"GuideScene");var MyAlbum=function(e){function t(){var t=e.call(this)||this;return t.m_pic=null,t.initAlbum(),t}return __extends(t,e),t.prototype.initAlbum=function(){var e=new egret.Bitmap;e.texture=RES.getRes("main_json.album"),this.m_pic=new egret.Bitmap,this.m_pic.width=114,this.m_pic.height=112,this.m_pic.texture=RES.getRes("main_json.default_logo"),this.m_pic.x=(e.width-this.m_pic.width)/2,this.m_pic.y=(e.height-this.m_pic.height)/2-8,this.addChild(this.m_pic),this.addChild(e)},t.prototype.showPic=function(e){if(e){var t=new egret.ImageLoader;t.addEventListener(egret.Event.COMPLETE,this.loadCompleteHandler,this),t.load(e)}},t.prototype.loadCompleteHandler=function(e){var t=e.currentTarget;this.m_pic&&(this.m_pic.bitmapData=t.data)},t}(eui.Group);__reflect(MyAlbum.prototype,"MyAlbum");var MyChest=function(e){function t(){var t=e.call(this)||this;return t.m_oChest=null,t.m_oFinger=null,t.m_fOnTapped=null,t.m_aThisObj=null,t.initChest(),t}return __extends(t,e),t.prototype.initChest=function(){var e=RES.getRes("chest_ske_json"),t=RES.getRes("chest_tex_json"),i=RES.getRes("chest_tex_png"),s=new dragonBones.EgretFactory;s.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(e)),s.addTextureAtlas(new dragonBones.EgretTextureAtlas(i,t),"chest"),this.m_oChest=s.buildArmature("chest"),dragonBones.WorldClock.clock.add(this.m_oChest),this.addChild(this.m_oChest.display),t=RES.getRes("finger_mc_json"),i=RES.getRes("finger_tex_png");var o=new egret.MovieClipDataFactory(t,i);this.m_oFinger=new egret.MovieClip(o.generateMovieClipData("finger")),this.m_oFinger.x=80,this.m_oFinger.y=-80,this.addChild(this.m_oFinger),this.m_oFinger.visible=!1,this.scaleX=this.scaleY=.1,this.alpha=0,this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},t.prototype.onTouch=function(e){this.m_fOnTapped&&this.m_fOnTapped.call(this.m_aThisObj)},t.prototype.showChest=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.m_oChest&&(this.m_fOnTapped=t,this.m_aThisObj=i,this.m_oChest.animation.gotoAndPlay("shake",-1,-1,0),egret.Tween.get(this).to({scaleX:.5,scaleY:.5,y:this.y-100,alpha:1},300,egret.Ease.sineIn).to({scaleX:1,scaleY:1,y:e},500,egret.Ease.bounceOut).call(function(){this.m_oFinger&&(this.m_oFinger.visible=!0,this.m_oFinger.play(-1))},this))},t}(eui.Group);__reflect(MyChest.prototype,"MyChest");var MyCombo=function(e){function t(){var t=e.call(this)||this;return t.m_oComboFontLabel=null,t.initCombo(),t}return __extends(t,e),t.prototype.initCombo=function(){var e=new egret.Bitmap;e.texture=RES.getRes("main_json.combo_bg"),this.addChild(e),this.width=e.width,this.height=e.height,this.m_oComboFontLabel=new ZephBMPFontLabel(null,0,"cb_",null,null),this.m_oComboFontLabel.x=e.width/2+30,this.m_oComboFontLabel.y=e.height/2,this.addChild(this.m_oComboFontLabel)},t.prototype.setComboText=function(e){this.m_oComboFontLabel&&e&&(this.m_oComboFontLabel.setText(e),egret.Tween.removeTweens(this.m_oComboFontLabel),this.m_oComboFontLabel.scaleX=this.m_oComboFontLabel.scaleY=1,egret.Tween.get(this.m_oComboFontLabel).to({scaleX:1.5,scaleY:1.5},100,egret.Ease.sineIn).to({scaleX:1,scaleY:1},50,egret.Ease.sineOut))},t.prototype.showCombo=function(e){!this.m_oComboFontLabel||0>=e||(egret.Tween.removeTweens(this),this.setComboText(""+e),this.alpha=1,egret.Tween.get(this).wait(3e3).to({alpha:0},300))},t}(eui.Group);__reflect(MyCombo.prototype,"MyCombo");var MyDialog=function(e){function t(t){var i=e.call(this)||this;return i.m_oDialog=null,i.m_oText=null,i.alpha=0,i.initDialog(t),i}return __extends(t,e),t.prototype.initDialog=function(e){e&&(this.m_oDialog=new egret.Bitmap,this.m_oDialog.texture=RES.getRes(e),this.addChild(this.m_oDialog),this.width=this.m_oDialog.width,this.height=this.m_oDialog.height,this.m_oText=new egret.TextField,this.m_oText.size=22,this.m_oText.multiline=!0,this.m_oText.width=168,this.m_oText.textColor=0,this.m_oText.x=15,this.m_oText.y=20,this.addChild(this.m_oText))},t.prototype.getRandomText=function(){var e=Math.floor(Math.random()*GuardText.m_aText.length);return GuardText.m_aText[e]},t.prototype.showDialog=function(){egret.Tween.removeTweens(this),this.alpha=0,this.m_oText.text=this.getRandomText(),egret.Tween.get(this).to({alpha:1},800).wait(5e3).to({alpha:0},300)},t}(eui.Group);__reflect(MyDialog.prototype,"MyDialog");var GuardText=function(){function e(){}return e}();GuardText.m_aText=["我，只是一个小兵","真实的东西是最不好看的","你留下，或者我跟你走","如果有多一张船票，你会不会跟我走","其实，我是一个演员","他不是低能，他只是善良","生活就像一盒巧克力，你永远不知道你会得到什么","如果我知道怎么舍弃你，那该有多好","不是子弹，而是美女杀死了野兽","感情就这样，你伤了别人，无论有意无意，就总会有个人来伤你","我甚至连她的一张照片都没有。她只活在我的记忆里","我们现在是谈生意，不是谈恋爱","不如我们重新开始","心里有就有，心里没有就没有","你千年修行，为了一个他，值得吗","拥抱真是很奇妙，虽然两颗心靠得很近，却看不见对方的脸","有人就有恩怨，有恩怨就有江湖","人就是江湖，你怎么退出","人生下来的时候都只有一半，为了找到另一半而在人世间行走","有些人一辈子都在骗人，而有些人用一辈子去骗一个人","往往都是事情改变人，人却改变不了事情","一个受伤的人，不知道如何接受和给予爱","爱情这东西，时间很关键。认识得太早或太晚，都不行","我不想家庭是从说谎开始的，这令人厌恶","如果有一天我忍不住问你，你一定要骗我","就算你心里多不情愿，也不要告诉我你最爱的人不是我","没有法律。没有限制","只有一条规则：永远也别坠入爱河","我不想按别人的方式去生活","我不知道该说什么，我只是突然在那一刻很想念她","好多东西都没了，就象是遗失在风中的烟花","点了这么多下，你是真无聊，还是觉得我说得对","我不是Siri，你也不是真无聊，对么","休息，休息一下","差不多就好了，头都被你戳疼了"],__reflect(GuardText.prototype,"GuardText");var MyExpProgress=function(e){function t(t,i,s,o,n,r,a){return void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=!1),e.call(this,t,i,s,o,n,r,a)||this}return __extends(t,e),t.prototype.shake=function(e,t){var i=egret.Tween.get(this);i.to({x:e-5*Math.random(),y:t-20*Math.random()},25,egret.Ease.sineIn).to({x:e,y:t+10*Math.random()},25,egret.Ease.sineIn).to({x:e+10*Math.random(),y:t-10*Math.random()},25,egret.Ease.sineIn).to({x:e-10*Math.random(),y:t},25,egret.Ease.sineIn).to({x:e,y:t},25,egret.Ease.sineIn)},t}(ZephProgress);__reflect(MyExpProgress.prototype,"MyExpProgress");var MyFamous=function(e){function t(t){var i=e.call(this)||this;return i.initFamous(t),i}return __extends(t,e),t.prototype.initFamous=function(e){if(e){var t=new egret.Bitmap;t.texture=RES.getRes("harvest_json.famous"),this.addChild(t),this.width=t.width,this.height=t.height;var i=new egret.Bitmap;i.texture=RES.getRes(e.m_sIconName),i.width=80,i.height=80,i.x=45,i.y=(this.height-i.height)/2,this.addChild(i);var s=new egret.Bitmap;s.texture=RES.getRes("harvest_json.medal"),s.x=i.x-10,s.y=i.y-10,this.addChild(s);var o=new egret.Bitmap;o.texture=RES.getRes("harvest_json.high_score"),o.x=i.x+i.width+14,o.y=30,this.addChild(o);var n=new egret.TextField;n.text=e.m_sNickName,n.size=24,n.textColor=0,n.x=o.x+10,n.y=o.y+o.height+10,this.addChild(n);var r=new ZephBMPFontLabel(null,0,"hs_","");r.setText(""+e.m_iScore),r.x=this.width-r.width-50,r.y=this.height/2-r.height/2,this.addChild(r)}},t}(eui.Group);__reflect(MyFamous.prototype,"MyFamous");var FamousData=function(){function e(){this.m_sIconName="",this.m_sNickName="",this.m_iScore=0}return e}();__reflect(FamousData.prototype,"FamousData");var MyGuard=function(e){function t(t,i,s,o,n){var r=e.call(this)||this;return r.m_sSkeletonData=null,r.m_sTextureData=null,r.m_sTexture=null,r.m_oParent=null,r.m_sGuardName="",r.m_oGuard=null,r.m_oDialogBox=null,r.m_sSkeletonData=s,r.m_sTextureData=o,r.m_sTexture=n,r.m_sGuardName=i,r.m_oParent=t,r.initGuard(),r.initDialogBox(),r.m_oGuard.display.touchEnabled=!0,r.m_oDialogBox.touchEnabled=!1,r.touchEnabled=!1,r.addEventListener(egret.TouchEvent.TOUCH_TAP,r.onTouch,r),r}return __extends(t,e),t.prototype.onTouch=function(e){this.m_oDialogBox&&this.m_oDialogBox.showDialog()},t.prototype.initGuard=function(){if(this.m_sSkeletonData&&this.m_sTextureData&&this.m_sTexture){var e=RES.getRes(this.m_sSkeletonData),t=RES.getRes(this.m_sTextureData),i=RES.getRes(this.m_sTexture),s=new dragonBones.EgretFactory;s.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(e)),s.addTextureAtlas(new dragonBones.EgretTextureAtlas(i,t),this.m_sGuardName),this.m_oGuard=s.buildArmature(this.m_sGuardName),dragonBones.WorldClock.clock.add(this.m_oGuard),this.m_oGuard.display.scaleX=this.m_oGuard.display.scaleY=1.5,this.addChild(this.m_oGuard.display)}},t.prototype.initDialogBox=function(){this.m_oDialogBox=new MyDialog("main_json.dialog_box"),this.m_oDialogBox.x=-this.m_oDialogBox.width,this.m_oDialogBox.y=-this.m_oGuard.display.height-this.m_oDialogBox.height,this.addChild(this.m_oDialogBox)},t.prototype.startPatrol=function(e,t){egret.Tween.removeTweens(this),this.x=e,this.m_oGuard.display.skewY=0,this.m_oGuard.animation.gotoAndPlay("Run",-1,-1,0),egret.Tween.get(this,{loop:!0}).to({x:t},5e3).wait(1e3).call(function(){this.m_oGuard.display.skewY=180},this).to({x:e},5e3).wait(1e3).call(function(){this.m_oGuard.display.skewY=0},this)},t}(eui.Group);__reflect(MyGuard.prototype,"MyGuard");var HarvestScene=function(e){function t(){var t=e.call(this)||this;return t.m_oStarGroup=null,t.m_oScore=null,t.m_oTime=null,t.m_oItem1=null,t.m_oItem2=null,t.m_oItem3=null,t.m_oFamous=null,GetRequest.httpReq.get(""+UserInfo.sUserHttpUrl+"/router/getUserAward","userid="+UserInfo.sUserID,t.UserAwardCallBack,t),t}return __extends(t,e),t.prototype.UserAwardCallBack=function(e){console.log(e)},t.prototype.initScene=function(){var e=new egret.Shape;e.graphics.beginFill(0),e.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight),e.graphics.endFill(),e.alpha=.7,this.addChild(e);var t=new egret.Bitmap;t.texture=RES.getRes("harvest_json.light"),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=this.width/2,t.y=this.height/2.3,t.scaleX=t.scaleY=2,this.addChild(t),egret.Tween.get(t,{loop:!0}).to({rotation:360},1e4);var i=new egret.Bitmap;i.texture=RES.getRes("harvest_json.harvest_bg"),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.x=this.width/2,i.y=this.height/2.3,this.addChild(i),this.m_oStarGroup=new MyStarGroup,this.m_oStarGroup.x=this.width/2,this.m_oStarGroup.y=this.height/4.5-10,this.addChild(this.m_oStarGroup);var s=new egret.Bitmap;s.texture=RES.getRes("harvest_json.defen"),s.x=this.width/2-s.width/2,s.y=this.m_oStarGroup.y+this.m_oStarGroup.height/2+40,this.addChild(s),this.m_oScore=new ZephBMPFontLabel(null,0,"sc_"),this.m_oScore.setText("123456789"),this.m_oScore.x=this.width/2-this.m_oScore.width/2,this.m_oScore.y=s.y+50,this.addChild(this.m_oScore),this.m_oTime=new ZephBMPFontLabel(null,0,"tm_","l"),this.m_oTime.setText("12d3h45m12s"),this.m_oTime.x=this.width/2-this.m_oTime.width/2,this.m_oTime.y=this.m_oScore.y+70,this.addChild(this.m_oTime);for(var o=new Array,n=0;3>n;n++){var r=new PrizeItemData;r.m_sIconName="harvest_json.icon_money",r.m_sItemName="理财红包 × 18888 元",r.m_sDateTime="2017-05-01 20:56:21",o.push(r)}this.m_oItem1=new MyPrizeItem(o[0]),this.m_oItem1.x=this.width/2-this.m_oItem1.width/2,this.m_oItem1.y=this.m_oTime.y+60,this.addChild(this.m_oItem1),this.m_oItem2=new MyPrizeItem(o[1]),this.m_oItem2.x=this.width/2-this.m_oItem2.width/2,this.m_oItem2.y=this.m_oItem1.y+this.m_oItem1.height+20,this.addChild(this.m_oItem2),this.m_oItem3=new MyPrizeItem(o[2]),this.m_oItem3.x=this.width/2-this.m_oItem3.width/2,this.m_oItem3.y=this.m_oItem2.y+this.m_oItem2.height+20,this.addChild(this.m_oItem3);var a=new ZephButton("harvest_json.prize_btn","harvest_json.lingqu");a.x=this.width/2,a.y=i.y+i.height/2,this.addChild(a),a.setTapCallBack(this.onButtonTapped,this);var h=new FamousData;h.m_sIconName="main_json.default_logo",h.m_sNickName="Tronker",h.m_iScore=123456789,this.m_oFamous=new MyFamous(h),this.m_oFamous.x=this.width/2-this.m_oFamous.width/2,this.m_oFamous.y=i.y+i.height/2+70,this.addChild(this.m_oFamous),this.m_oStarGroup.showStar(3)},t.prototype.onButtonTapped=function(e){this.m_onLeaveScene&&this.m_onLeaveScene.call(this.m_onLeaveThisObj),SceneManager.cutToScene(SceneType.HOME,null,null,!0,!0,!1)},t}(SceneBase);__reflect(HarvestScene.prototype,"HarvestScene");var MyStar=function(e){function t(){var t=e.call(this)||this;return t.m_oStar=null,t.initStar(),t}return __extends(t,e),t.prototype.initStar=function(){var e=new egret.Bitmap;e.texture=RES.getRes("harvest_json.star_bg"),this.addChild(e),this.width=e.width,this.height=e.height,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.m_oStar=new egret.Bitmap,this.m_oStar.texture=RES.getRes("harvest_json.star"),this.m_oStar.anchorOffsetX=this.m_oStar.width/2,this.m_oStar.anchorOffsetY=this.m_oStar.height/2,this.m_oStar.x=this.width/2,this.m_oStar.y=this.height/2,this.m_oStar.scaleX=this.m_oStar.scaleY=.1,this.m_oStar.alpha=0,this.addChild(this.m_oStar)},t.prototype.showStar=function(e){void 0===e&&(e=0),this.m_oStar&&(this.m_oStar.scaleX=this.m_oStar.scaleY=.1,this.m_oStar.alpha=0,egret.Tween.get(this.m_oStar).wait(e).to({scaleX:1.4,scaleY:1.4,alpha:1},300,egret.Ease.sineIn).to({scaleX:1,scaleY:1},200,egret.Ease.sineOut))},t}(eui.Group);__reflect(MyStar.prototype,"MyStar");var MyStarGroup=function(e){function t(){var t=e.call(this)||this;return t.m_aStarGrp=null,t.initStarGrp(),t}return __extends(t,e),t.prototype.initStarGrp=function(){this.m_aStarGrp=new Array;for(var e=0;3>e;e++){var t=new MyStar;this.addChild(t),this.m_aStarGrp[e]=t}this.m_aStarGrp[0].rotation=-15,this.m_aStarGrp[0].scaleX=this.m_aStarGrp[0].scaleY=.8,this.m_aStarGrp[0].x=this.m_aStarGrp[1].x-this.m_aStarGrp[0].width-20,this.m_aStarGrp[0].y=this.m_aStarGrp[1].y+10,this.m_aStarGrp[2].rotation=15,this.m_aStarGrp[2].scaleX=this.m_aStarGrp[2].scaleY=.8,this.m_aStarGrp[2].x=this.m_aStarGrp[1].x+this.m_aStarGrp[1].width+20,this.m_aStarGrp[2].y=this.m_aStarGrp[1].y+10},t.prototype.showStar=function(e){if(!(0>=e||e>3))for(var t=0;e>t;t++){var i=this.m_aStarGrp[t];i&&i.showStar(200*t)}},t}(eui.Group);__reflect(MyStarGroup.prototype,"MyStarGroup");var MyTrees=function(e){function t(t,i,s,o){var n=e.call(this)||this;return n.m_aTreeDatas=null,n.m_sTextureData=null,n.m_sTexture=null,n.m_iCurrentLevel=0,n.m_fPopFinished=null,n.m_oParent=null,n.m_aTreeDatas=i,n.m_sTextureData=s,n.m_sTexture=o,n.m_oParent=t,n.initTree(),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onTouch,n),n}return __extends(t,e),t.prototype.onTouch=function(e){this.playAni()},t.prototype.initTree=function(){if(this.m_aTreeDatas&&!(this.m_aTreeDatas.length<=0)&&this.m_sTextureData&&this.m_sTexture)for(var e=0;e<this.m_aTreeDatas.length;e++)if(this.m_aTreeDatas[e]){var t=RES.getRes(this.m_aTreeDatas[e].m_sTreeSkeletonData),i=RES.getRes(this.m_sTextureData),s=RES.getRes(this.m_sTexture),o=new dragonBones.EgretFactory;o.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(t)),o.addTextureAtlas(new dragonBones.EgretTextureAtlas(s,i),this.m_aTreeDatas[e].m_sTreeName);var n=o.buildArmature(this.m_aTreeDatas[e].m_sTreeName);dragonBones.WorldClock.clock.add(n),this.m_aTreeDatas[e].m_Tree=n;var r=n.getDisplay();r.visible=!1,this.m_iCurrentLevel=0,this.addChild(r)}},t.prototype.getTree=function(e){if(!this.m_aTreeDatas||this.m_aTreeDatas.length<e||0>=e)return null;for(var t=0,i=this.m_aTreeDatas;t<i.length;t++){var s=i[t];if(s&&s.m_iLevel==e)return s}return null},t.prototype.showTree=function(e){if(!(!this.m_aTreeDatas||this.m_aTreeDatas.length<e||0>=e)){var t=this.getTree(e);t&&t.m_Tree&&(this.setAllTreeInvisable(),t.m_Tree.getDisplay().visible=!0,this.m_iCurrentLevel=e,t.m_Tree.animation.gotoAndPlay(t.m_sAniName,-1,-1,1))}},t.prototype.setAllTreeInvisable=function(){if(this.m_aTreeDatas)for(var e=0,t=this.m_aTreeDatas;e<t.length;e++){var i=t[e];i&&i.m_Tree&&(i.m_Tree.getDisplay().visible=!1)}},t.prototype.playAni=function(){var e=this.getTree(this.m_iCurrentLevel);e&&e.m_Tree&&e.m_Tree.animation.gotoAndPlay(e.m_sAniName,-1,-1,1)},t.prototype.popSun=function(e,t,i,s,o){if(!(0>=e)&&t){this.m_fPopFinished=o;for(var n=0;e>n;n++){var r=new eui.Image;r.texture=RES.getRes(t),r.x=this.x,r.y=this.y,r.scaleX=r.scaleY=.1;var a=.3*Math.random()+.4,h=this.x+200*(Math.random()>=.5?Math.random():Math.random()-1),m=this.y+50*Math.random();this.m_oParent.addChild(r),egret.Tween.get(r).wait(100*n).to({x:h,y:m,scaleX:a,scaleY:a},300,egret.Ease.sineIn).wait(1500).to({x:i,y:s,scaleX:.1,scaleY:.1,rotation:720},500,egret.Ease.quintIn).call(this.m_fPopFinished,this.m_oParent,[r])}}},t}(eui.Group);__reflect(MyTrees.prototype,"MyTrees");var MyTreeData=function(){function e(){this.m_iLevel=0,this.m_sTreeName="",this.m_sTreeSkeletonData="",this.m_sAniName="",this.m_Tree=null}return e}();__reflect(MyTreeData.prototype,"MyTreeData");var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){SceneManager.setMain(this),SceneManager.cutToScene(SceneType.LOADING,this.enterGame,this)},t.prototype.enterGame=function(){UserInfo.sUserID=ZephUtil.getUrlParam("id"),UserInfo.sUserToken=ZephUtil.getUrlParam("tk"),!UserInfo.getUserInfo(),UserInfo.bIsNewBee=!1,UserInfo.bIsNewBee?SceneManager.cutToScene(SceneType.GUIDE,null,null,!0,!0):SceneManager.cutToScene(SceneType.HOME,null,null,!0,!0),egret.Ticker.getInstance().register(function(e){dragonBones.WorldClock.clock.advanceTime(-1)},this)},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var SceneManager=function(){function e(){}return e.getSceneByType=function(t){switch(t){case SceneType.LOADING:return e.m_loading||(e.m_loading=new LoadingScene),e.m_loading;case SceneType.HOME:return e.m_home||(e.m_home=new HomeScene),e.m_home;case SceneType.GUIDE:return e.m_guide||(e.m_guide=new GuideScene),e.m_guide;case SceneType.HARVEST:return e.m_harvest||(e.m_harvest=new HarvestScene),e.m_harvest}return null},e.setMain=function(t){e.m_main=t,t&&t.stage&&e.setStageWH(t.stage.stageWidth,t.stage.stageHeight)},e.setStageWH=function(t,i){e.m_stageWidth=t,e.m_stageHeight=i},e.cutToScene=function(t,i,s,o,n,r){if(void 0===i&&(i=null),void 0===s&&(s=null),void 0===o&&(o=!0),void 0===n&&(n=!1),void 0===r&&(r=!0),!e.m_main)return null;var a=e.getSceneByType(t);if(!a)return null;if(a.width=e.m_stageWidth,a.height=e.m_stageHeight,e.m_main.stage.addChild(a),null!=e.m_currentSceneType){var h=e.getSceneByType(e.m_currentSceneType);h&&o&&e.m_main.stage.removeChild(h),n&&e.cleanSceneByType(e.m_currentSceneType)}return e.m_currentSceneType=t,r&&a.initScene(),i&&a.setLeaveSceneCallBack(i,s),a},e.cleanSceneByType=function(t){switch(t){case SceneType.LOADING:e.m_loading=null;break;case SceneType.HOME:e.m_home=null;break;case SceneType.GUIDE:e.m_guide=null;break;case SceneType.HARVEST:e.m_harvest=null}},e}();SceneManager.m_loading=null,SceneManager.m_home=null,SceneManager.m_guide=null,SceneManager.m_harvest=null,SceneManager.m_main=null,SceneManager.m_currentSceneType=null,SceneManager.m_stageWidth=0,SceneManager.m_stageHeight=0,__reflect(SceneManager.prototype,"SceneManager");var SceneType;!function(e){e[e.LOADING=0]="LOADING",e[e.HOME=1]="HOME",e[e.GUIDE=2]="GUIDE",e[e.HARVEST=3]="HARVEST"}(SceneType||(SceneType={}));var UserInfo=function(){function e(){}return e.getUserInfo=function(t,i){return void 0===t&&(t=""),void 0===i&&(i=""),t||(t=e.sUserID),i||(i=e.sUserToken),!0},e}();UserInfo.sUserID="",UserInfo.sUserToken="",UserInfo.bIsNewBee=!0,UserInfo.sUserPicUrl="",UserInfo.iUserCurrentExp=20,UserInfo.iUserCurrentMaxExp=100,UserInfo.iUserCurrentLevel=1,UserInfo.USER_MAX_LEVEL=7,UserInfo.sUserHttpUrl="http://192.168.1.75:9091",__reflect(UserInfo.prototype,"UserInfo");var ZephBMPFontLabel=function(e){function t(t,i,s,o,n){void 0===t&&(t=null),void 0===i&&(i=0),void 0===s&&(s=""),void 0===o&&(o="l"),void 0===n&&(n="p");var r=e.call(this)||this;r.m_fontItem=null,r.m_prefix=null,r.m_icon=null,r.m_percent=null,r.m_text=null,r.m_fontItem=t,r.m_prefix=s,r.m_icon=o,r.m_percent=n;var a=new eui.HorizontalLayout;return a.horizontalAlign=egret.HorizontalAlign.CENTER,a.verticalAlign=egret.VerticalAlign.BOTTOM,a.gap=i,r.layout=a,r}return __extends(t,e),t.prototype.getText=function(){return this.m_text},t.prototype.setText=function(e){this.m_text=e,this.m_icon&&(e=this.m_icon+e),this.removeChildren();for(var t=0,i=0,s=0;s<e.length;s++){var o=e.charAt(s);"%"==o&&(o=this.m_percent);var n=null;if(n=this.m_fontItem?this.m_fontItem.getTexture(this.m_prefix+o):RES.getRes(this.m_prefix+o)){var r=new eui.Image(n);r&&(this.addChild(r),t+=n.textureWidth,n.textureHeight>i&&(i=n.textureHeight))}}this.width=t,this.height=i},t}(eui.Group);__reflect(ZephBMPFontLabel.prototype,"ZephBMPFontLabel");var ZephButton=function(e){function t(t,i,s,o){void 0===s&&(s=1),void 0===o&&(o=null);var n=e.call(this)||this;n.m_ButtonImage=null,n.m_IconImage=null,n.m_DisableMaskImage=null,n.m_Scale=1,n.m_State=ZephButtonState.DISABLE,n.m_onTapCallBack=null,n.m_onTapThisObj=null,n.m_bCanBeTapped=!0;var r=RES.getRes(t);r&&(n.m_ButtonImage=new eui.Image,n.m_ButtonImage.texture=r,n.addChild(n.m_ButtonImage));var a=RES.getRes(i);a&&(n.m_IconImage=new eui.Image,n.m_IconImage.texture=a,n.addChild(n.m_IconImage),n.m_IconImage.anchorOffsetX=n.m_IconImage.width/2,n.m_IconImage.anchorOffsetY=n.m_IconImage.height/2,n.m_IconImage.horizontalCenter=0,n.m_IconImage.verticalCenter=0);var h=RES.getRes(o);return h&&(n.m_DisableMaskImage=new eui.Image,n.m_DisableMaskImage.texture=h,n.m_DisableMaskImage.anchorOffsetX=n.m_DisableMaskImage.width/2,n.m_DisableMaskImage.anchorOffsetY=n.m_DisableMaskImage.height/2,n.m_DisableMaskImage.horizontalCenter=0,n.m_DisableMaskImage.verticalCenter=0,n.m_DisableMaskImage.visiable=!1,n.addChild(n.m_DisableMaskImage)),n.setState(ZephButtonState.UP),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouch,n),n.addEventListener(egret.TouchEvent.TOUCH_END,n.onTouch,n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onTouch,n),n.m_Scale=s,n.scaleX=n.scaleY=n.m_Scale,n}return __extends(t,e),t.prototype.setCanBeTapped=function(e){this.m_bCanBeTapped=e},t.prototype.setTapCallBack=function(e,t,i){void 0===i&&(i=null),this.m_onTapCallBack=e,this.m_onTapThisObj=t,i&&(this.name=i)},t.prototype.setCenterAnchor=function(){this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2},t.prototype.setState=function(e){switch(e){case ZephButtonState.UP:this.scaleX=this.scaleY=this.m_Scale,this.touchEnabled=!0;break;case ZephButtonState.DOWN:this.scaleX=this.scaleY=.95*this.m_Scale,this.touchEnabled=!0;break;case ZephButtonState.DISABLE:this.scaleX=this.scaleY=this.m_Scale,this.touchEnabled=!1;break;default:return}this.m_State=e,this.width=this.m_ButtonImage.width,this.height=this.m_ButtonImage.height,this.setCenterAnchor(),this.setMaskVisiable(e)},t.prototype.setMaskVisiable=function(e){if(this.m_DisableMaskImage)switch(e){case ZephButtonState.UP:this.m_DisableMaskImage.visiable=!1;break;case ZephButtonState.DOWN:this.m_DisableMaskImage.visiable=!1;break;case ZephButtonState.DISABLE:this.m_DisableMaskImage.visiable=!0;break;default:return}},t.prototype.onTouch=function(e){switch(e.type){case egret.TouchEvent.TOUCH_BEGIN:this.setState(ZephButtonState.DOWN);break;case egret.TouchEvent.TOUCH_END:this.setState(ZephButtonState.UP);break;case egret.TouchEvent.TOUCH_TAP:this.m_onTapCallBack&&this.m_bCanBeTapped&&this.m_onTapCallBack.call(this.m_onTapThisObj,this.name);break;default:return}},t}(eui.Group);__reflect(ZephButton.prototype,"ZephButton");var ZephButtonState;!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.DISABLE=2]="DISABLE"}(ZephButtonState||(ZephButtonState={}));var HomeScene=function(e){function t(){var t=e.call(this)||this;return t.m_oAlbum=null,t.m_oExpProgress=null,t.m_oNewsBtn=null,t.m_oSpadeBtn=null,t.m_oKettleBtn=null,t.m_oTrees=null,t.m_oGuard=null,t.m_oSpadeImg=null,t.m_iSpadeImgX=0,t.m_iSpadeImgY=0,t.m_oKettleImg=null,t.m_iKettleImgX=0,t.m_iKettleImgY=0,t.m_oCombo=null,t.m_oChest=null,t.m_bIsPlayActionAni=!1,t.m_bIsWaitingResp=!1,t.m_bIsResvExp=!0,t.l_myExp=null,t.l_HttpPostparams=null,t.l_spadeStatus=1,t}return __extends(t,e),t.prototype.initScene=function(){var e=new egret.Bitmap;
e.texture=RES.getRes("main_json.bg"),e.x=(this.width-e.width)/2,e.y=(this.height-e.height)/2,this.addChild(e),this.m_oAlbum=new MyAlbum,this.m_oAlbum.x=20,this.m_oAlbum.y=30,this.addChild(this.m_oAlbum),this.m_oAlbum.showPic(UserInfo.sUserPicUrl),GetRequest.httpReq.get(""+UserInfo.sUserHttpUrl+"/router/getUserWheel","userid="+UserInfo.sUserID,this.MyExpProgCallBack,this),this.m_oExpProgress=new MyExpProgress(this.onLevelUp,this,"main_json.jindu_bg","main_json.jindutiao"),this.m_oExpProgress.x=200,this.m_oExpProgress.y=42,this.m_oExpProgress.setProgressOffset(107,30),this.addChild(this.m_oExpProgress),this.m_oNewsBtn=new ZephButton("main_json.button","main_json.icon_info",.65),this.m_oNewsBtn.x=this.width-80,this.m_oNewsBtn.y=90,this.addChild(this.m_oNewsBtn),this.m_oNewsBtn.setTapCallBack(this.onButtonTapped,this,"news"),this.m_oSpadeBtn=new ZephButton("main_json.button","main_json.icon_chan"),this.m_oSpadeBtn.x=this.width/4,this.m_oSpadeBtn.y=this.height-140,this.addChild(this.m_oSpadeBtn),HomeActionResq.m_iSendTime-HomeActionResq.m_iRecvTime>=0&&HomeActionResq.m_iCurrentLevel<7&&(this.m_oSpadeBtn.setTapCallBack(this.onButtonTapped,this,"spade"),this.l_spadeStatus=0),this.m_oKettleBtn=new ZephButton("main_json.button","main_json.icon_shui"),this.m_oKettleBtn.x=this.width/4*3,this.m_oKettleBtn.y=this.height-140,this.addChild(this.m_oKettleBtn),HomeActionResq.l_iKettleSendTime-HomeActionResq.m_iRecvTime>=0&&HomeActionResq.m_iCurrentLevel<7&&this.m_oKettleBtn.setTapCallBack(this.onButtonTapped,this,"kettle"),this.m_oTrees=this.createMagicTree(),this.m_oTrees&&(this.m_oTrees.x=this.width/2,this.m_oTrees.y=this.height/3*2,this.m_oTrees.showTree(UserInfo.iUserCurrentLevel),this.addChild(this.m_oTrees)),this.m_oGuard=new MyGuard(this,"huwei","huwei_ske_json","huwei_tex_json","huwei_tex_png"),this.m_oGuard&&(this.m_oGuard.x=this.width/4,this.m_oGuard.y=this.height/4*3,this.addChild(this.m_oGuard),this.m_oGuard.startPatrol(this.m_oGuard.x,3*this.m_oGuard.x)),this.m_oCombo=new MyCombo,this.m_oCombo.x=this.width/2-this.m_oCombo.width/1.7,this.m_oCombo.y=this.height/5,this.m_oCombo.rotation=-15,this.m_oCombo.alpha=0,this.addChild(this.m_oCombo),this.createAni(),this.m_oChest=new MyChest,this.m_oChest.x=this.m_oTrees.x,this.m_oChest.y=this.m_oTrees.y,this.addChild(this.m_oChest),this.m_oChest.showChest(this.height-50,this.onShowPrize,this)},t.prototype.createAni=function(){this.m_oSpadeImg=new egret.Bitmap,this.m_oSpadeImg.texture=RES.getRes("main_json.chanzi"),this.m_oSpadeImg.anchorOffsetX=this.m_oSpadeImg.width,this.m_iSpadeImgX=this.m_oSpadeImg.x=this.m_oTrees.x+1.5*this.m_oSpadeImg.width,this.m_iSpadeImgY=this.m_oSpadeImg.y=this.m_oTrees.y-2*this.m_oSpadeImg.height,this.m_oSpadeImg.alpha=0,this.addChild(this.m_oSpadeImg),this.m_oKettleImg=new egret.Bitmap,this.m_oKettleImg.texture=RES.getRes("main_json.shuihu"),this.m_oKettleImg.anchorOffsetX=this.m_oKettleImg.width/2,this.m_oKettleImg.anchorOffsetY=this.m_oKettleImg.height/2,this.m_iKettleImgX=this.m_oKettleImg.x=this.m_oTrees.x+this.m_oKettleImg.width,this.m_iKettleImgY=this.m_oKettleImg.y=this.m_oTrees.y-2*this.m_oKettleImg.height,this.m_oKettleImg.alpha=0,this.addChild(this.m_oKettleImg)},t.prototype.playSpadeAni=function(){this.m_oSpadeImg&&(this.m_bIsPlayActionAni=!0,egret.Tween.removeTweens(this.m_oSpadeImg),this.m_oSpadeImg.alpha=0,this.m_oSpadeImg.rotation=0,this.m_oSpadeImg.x=this.m_iSpadeImgX,this.m_oSpadeImg.y=this.m_iSpadeImgY,egret.Tween.get(this.m_oSpadeImg).to({alpha:1,rotation:-20},300).wait(100).to({y:this.m_oSpadeImg.y+40,x:this.m_oSpadeImg.x-15},200,egret.Ease.quadOut).to({rotation:30,x:this.m_oSpadeImg.x-50},200,egret.Ease.quartIn).to({alpha:0},400).call(this.onActionFinished,this))},t.prototype.onActionFinished=function(){this.m_oSpadeBtn.setCanBeTapped(!0),this.m_oKettleBtn.setCanBeTapped(!0),this.m_bIsPlayActionAni=!1,HomeActionResq.m_iRecvTime<=0?this.m_bIsWaitingResp=!0:this.doResp()},t.prototype.doResp=function(){this.m_bIsWaitingResp,this.m_oTrees&&this.m_oExpProgress&&(this.m_oTrees.popSun(HomeActionResq.m_iCurrentRound,"main_json.icon_sun",380,80,this.onPopFinished),HomeActionResq.m_iComboCnt>1&&this.m_oCombo.showCombo(HomeActionResq.m_iComboCnt))},t.prototype.onPopFinished=function(e){this.removeChild(e),this.m_oExpProgress&&(this.m_oExpProgress.shake(200,42),this.m_bIsResvExp&&this.m_oExpProgress.addProgressRate(Math.floor(HomeActionResq.m_iGotExp/HomeActionResq.m_iCurrentRound/HomeActionResq.m_iCurrentMaxExp*100)))},t.prototype.playKettleAni=function(){this.m_oKettleImg&&(this.m_bIsPlayActionAni=!0,egret.Tween.removeTweens(this.m_oKettleImg),this.m_oKettleImg.alpha=0,this.m_oKettleImg.rotation=0,this.m_oKettleImg.x=this.m_iKettleImgX,this.m_oKettleImg.y=this.m_iKettleImgY,egret.Tween.get(this.m_oKettleImg).to({alpha:1,rotation:-20},300).wait(100).to({y:this.m_oKettleImg.y+40,x:this.m_oKettleImg.x-15},200,egret.Ease.quadOut).wait(300).to({rotation:20,y:this.m_oKettleImg.y-50},300,egret.Ease.quartIn).to({alpha:0},400).call(this.onActionFinished,this))},t.prototype.createMagicTree=function(){for(var e=new Array,t=1;7>=t;t++){var i=new MyTreeData;i.m_iLevel=t,i.m_sAniName="idle",i.m_sTreeName="tree"+t,i.m_sTreeSkeletonData=i.m_sTreeName+"_ske_json",e.push(i)}return new MyTrees(this,e,"tree_tex_json","tree_tex_png")},t.prototype.onButtonTapped=function(e){switch(e){case"news":this.doNews();break;case"spade":this.doSpade();break;case"kettle":this.doKettle();break;case"prize":this.doPrize()}},t.prototype.doNews=function(){},t.prototype.doSpade=function(){this.m_oSpadeBtn.setCanBeTapped(!1),this.m_oKettleBtn.setCanBeTapped(!1),this.playSpadeAni(),this.sendActionReq("spade")},t.prototype.doKettle=function(){this.m_oSpadeBtn.setCanBeTapped(!1),this.m_oKettleBtn.setCanBeTapped(!1),this.playKettleAni(),this.sendActionReq("kettle")},t.prototype.doPrize=function(){},t.prototype.sendActionReq=function(e){this.onResp()},t.prototype.onLevelUp=function(){if(this.m_oTrees){if(UserInfo.iUserCurrentLevel++,UserInfo.iUserCurrentLevel>UserInfo.USER_MAX_LEVEL)return this.m_bIsResvExp=!1,void this.onHarvest();this.m_oTrees.showTree(UserInfo.iUserCurrentLevel),this.m_oExpProgress.setProgressRate(0)}},t.prototype.onHarvest=function(){this.m_oKettleBtn.visible=!1,this.m_oSpadeBtn.visible=!1,this.m_oChest=new MyChest,this.m_oChest.x=this.m_oTrees.x,this.m_oChest.y=this.m_oTrees.y,this.addChild(this.m_oChest),this.m_oChest.showChest(this.height-50,this.onShowPrize,this)},t.prototype.onShowPrize=function(){this.m_oChest&&(this.removeChild(this.m_oChest),this.m_oChest=null),SceneManager.cutToScene(SceneType.HARVEST,this.onHarvestClosed,this,!1,!1)},t.prototype.onHarvestClosed=function(){this.m_oTrees.showTree(1),this.m_oExpProgress.setProgressRate(0),this.m_oKettleBtn.visible=!0,this.m_oSpadeBtn.visible=!0,HomeActionResq.m_iComboCnt=0,HomeActionResq.m_iCurrentExp=0,UserInfo.iUserCurrentLevel=1,this.m_bIsResvExp=!0},t.prototype.onResp=function(){HomeActionResq.m_iRecvTime=Date.now(),HomeActionResq.m_iGotExp=Math.ceil(200*Math.random())+300,HomeActionResq.m_iCurrentExp+=HomeActionResq.m_iGotExp,HomeActionResq.m_iCurrentMaxExp=1e3,HomeActionResq.m_iCurrentRound=Math.ceil(7*Math.random()),HomeActionResq.m_iComboCnt++},t.prototype.SpadeCallBack=function(e){HomeActionResq.l_iSpadeSendTime=e.resultToValidate.nextModify,HomeActionResq.m_iCurrentMaxExp=e.resultToValidate.experienceMax,HomeActionResq.m_iCurrentLevel=e.resultToValidate.grade,HomeActionResq.m_iComboCnt<e.resultToValidate.ComboCnt&&(HomeActionResq.m_iComboCnt=e.resultToValidate.ComboCnt),HomeActionResq.m_iCurrentExp=Math.ceil(e.resultToValidate.experience/e.resultToValidate.experienceMax*100),this.m_oExpProgress.setProgressRate(HomeActionResq.m_iCurrentExp)},t.prototype.KettleCallBack=function(e){HomeActionResq.l_iKettleSendTime=e.resultToValidate.nextModify,HomeActionResq.m_iCurrentMaxExp=e.resultToValidate.experienceMax,HomeActionResq.m_iCurrentLevel=e.resultToValidate.grade,HomeActionResq.m_iComboCnt<e.resultToValidate.ComboCnt&&(HomeActionResq.m_iComboCnt=e.resultToValidate.ComboCnt),HomeActionResq.m_iCurrentExp=Math.ceil(e.resultToValidate.experience/e.resultToValidate.experienceMax*100),this.m_oExpProgress.setProgressRate(HomeActionResq.m_iCurrentExp)},t.prototype.MyExpProgCallBack=function(e){HomeActionResq.m_iCurrentExp=Math.ceil(e.results.experience/e.results.experienceMax*100),this.m_oExpProgress.setProgressRate(HomeActionResq.m_iCurrentExp),HomeActionResq.m_iCurrentExp=e.results.experience,HomeActionResq.m_iCurrentMaxExp=e.results.experienceMax,HomeActionResq.m_iCurrentLevel=e.results.grade,HomeActionResq.m_iRecvTime=e.results.nextModify,HomeActionResq.m_iCurrentLevel=e.results.grade},t}(SceneBase);__reflect(HomeScene.prototype,"HomeScene");var HomeActionResq=function(){function e(){}return e}();HomeActionResq.m_iSendTime=0,HomeActionResq.m_iRecvTime=0,HomeActionResq.m_sProtocolName="",HomeActionResq.m_iGotExp=0,HomeActionResq.m_iCurrentExp=0,HomeActionResq.m_iCurrentMaxExp=0,HomeActionResq.m_iCurrentLevel=1,HomeActionResq.m_iCurrentRound=0,HomeActionResq.m_iComboCnt=0,HomeActionResq.l_iSpadeSendTime=Date.now(),HomeActionResq.l_iKettleSendTime=Date.now(),__reflect(HomeActionResq.prototype,"HomeActionResq");var GetRequest=function(e){function t(){var t=e.call(this)||this;return t.l_getUrl=null,t.l_params=null,t.l_judgeType=null,t.l_funcCallBack=null,t.l_thisObj=null,t}return __extends(t,e),t.prototype.get=function(e,t,i,s){void 0===i&&(i=null),void 0===s&&(s=null),this.l_funcCallBack=i,this.l_thisObj=s;var o=new egret.HttpRequest;o.responseType=egret.HttpResponseType.TEXT,o.open(e+"?"+t,egret.HttpMethod.GET),o.send(),this.addEvent(o)},t.prototype.post=function(e,t,i,s){void 0===i&&(i=null),void 0===s&&(s=null),this.l_funcCallBack=i,this.l_thisObj=s;var o=new egret.HttpRequest;o.responseType=egret.HttpResponseType.TEXT,o.open(e,egret.HttpMethod.POST),o.setRequestHeader("Content-Type","application/json;charset=utf-8"),o.send(t),this.addEvent(o)},t.prototype.addEvent=function(e){e.addEventListener(egret.Event.COMPLETE,this.onComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onProgress,this)},t.prototype.onComplete=function(e){var t=e.currentTarget,i=JSON.parse(t.response).data;this.l_funcCallBack&&this.l_funcCallBack.call(this.l_thisObj,i)},t.prototype.onIOError=function(e){console.log("get error : "+e)},t.prototype.onProgress=function(e){console.log("get progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},t}(egret.DisplayObjectContainer);GetRequest.httpReq=new GetRequest,__reflect(GetRequest.prototype,"GetRequest");var ZephUtil=function(){function e(){}return e.getUrlParam=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location;if(!i)return"";var s=i.search.substr(1).match(t);return s?decodeURI(s[2]):"1"},e}();__reflect(ZephUtil.prototype,"ZephUtil");